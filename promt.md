Mega Prompt: Build Full Stack CRM Automation (Backend + Frontend) From Zero to Hero
KONTEKS PROYEK
Kamu akan build Full-Stack CRM Automation Dashboard dengan arsitektur:

Backend: Node.js + Express.js + TypeScript di VPS Easypanel (PORT 4444)

Frontend: React di Vercel (CORS-enabled)

Database: PostgreSQL (5 tables + 2 views + business logic functions)

Integration: WhatsApp API gateway untuk send message

Teknologi Stack:

Backend: Express, Prisma ORM, JWT Auth, CORS, TypeScript

Frontend: React, TypeScript, Vite, TailwindCSS, Axios

Database: PostgreSQL dengan optimized indexes dan materialized views

Deployment: Vercel (frontend), Easypanel VPS (backend)

ENVIRONMENT VARIABLES
Backend (.env)
text
WHATSAPP_API_URL=https://app.notif.my.id/api/v2/send-message
WHATSAPP_API_KEY=sebb4t7b2nqRz30jOH1765467069373
NODE_ENV=production
PORT=4444
PUBLIC_URL=https://filter-bot-crmcutting.qk6yxt.easypanel.host/
DATABASE_URL=postgres://postgres:a0bd3b3c1d54b7833014@postgres_scrapdatan8n:5432/CRM?sslmode=disable
JWT_SECRET=a03b764e27cbccc3e1f1b7e8f490d5075a27de3a697aaecb0dcb587b8c70f5a74c0421d221e11c388f9cd95b4614b38e35f527f5803a63adb06c19de18f41e4e
CORS_ORIGIN=https://crm-n8n-dashboard.vercel.app
Frontend (.env)
text
REACT_APP_API_BASE_URL=https://filter-bot-crmcutting.qk6yxt.easypanel.host/api
DATABASE SCHEMA (5 TABLES + VIEWS + FUNCTIONS)
Tables
businesses
Lead database untuk prospecting (place_id, name, phone, rating, lead_score, campaign_batch)

customers
Customer/prospect conversation tracking (phone, name, status, conversation_stage, cooldown_until, message_count_today)

chat_history
Message log dengan AI classification (customer_id, message_type, content, escalated, classification, ai_confidence)

escalations
Escalation tracking (customer_id, escalation_type, priority_level, status, assigned_to)

knowledge_ai
Knowledge base untuk AI responses (category, keywords[], question_pattern, answer_template, priority, usage_count)

Materialized Views
customer_engagement_stats – Analytics per customer (total_chats, last_chat_at, escalation_count, avg_quality_score)

campaign_performance – Campaign metrics (total_leads, contacted, invalid, avg_lead_score, batch_date)

Functions
match_knowledge() – Search knowledge base by keywords dengan priority

update_knowledge_usage() – Track knowledge usage untuk analytics

Indexes
Optimized untuk queries: lead validation, campaign lookup, cooldown checks, escalation priority

BACKEND REQUIREMENTS
1. Project Structure
text
backend/
├── src/
│   ├── config/
│   │   ├── database.ts        // Prisma client + connection pool
│   │   └── env.ts             // Environment validation
│   ├── middleware/
│   │   ├── cors.ts            // CORS configuration
│   │   ├── errorHandler.ts    // Global error handling
│   │   └── auth.ts            // JWT middleware
│   ├── routes/
│   │   ├── businesses.ts      // CRUD + bulk import + lead scoring
│   │   ├── customers.ts       // CRUD + cooldown management + priority tracking
│   │   ├── chat.ts            // Message logging + AI classification + escalation
│   │   ├── escalations.ts     // CRUD + assignment + resolution
│   │   ├── knowledge.ts       // Knowledge base management + matching
│   │   ├── whatsapp.ts        // Send message via WhatsApp API + webhook handling
│   │   └── analytics.ts       // Dashboard stats from materialized views
│   ├── controllers/
│   │   ├── businessController.ts
│   │   ├── customerController.ts
│   │   ├── chatController.ts
│   │   ├── escalationController.ts
│   │   ├── knowledgeController.ts
│   │   └── analyticsController.ts
│   ├── services/
│   │   ├── whatsappService.ts         // Integration dengan WhatsApp API
│   │   ├── aiClassificationService.ts // Classify customer messages
│   │   ├── leadScoringService.ts      // Calculate lead_score based on engagement
│   │   └── cooldownService.ts         // Manage customer cooldown periods
│   ├── types/
│   │   ├── index.ts            // TypeScript interfaces/types
│   │   └── prisma.ts           // Prisma generated types
│   ├── utils/
│   │   ├── validators.ts       // Input validation
│   │   └── helpers.ts          // Utility functions
│   └── index.ts                // Main Express app
├── prisma/
│   └── schema.prisma           // Prisma ORM schema (autogenerated/from DB)
├── .env
├── .env.example
├── tsconfig.json
└── package.json
2. Core Features Implementation
A. CORS Configuration (Fixed & Tested)
KODE WAJIB DIGENERATE SEPERTI INI, AGAR TIDAK ADA ERROR CORS:

ts
// src/middleware/cors.ts
import cors from 'cors';
import { RequestHandler } from 'express';

export const corsMiddleware = (): RequestHandler => {
  if (!process.env.CORS_ORIGIN) {
    throw new Error('CORS_ORIGIN environment variable is required');
  }

  const origins = process.env.CORS_ORIGIN.split(',').map(o => o.trim());

  const options = {
    origin: origins,
    credentials: true,
    methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS'],
    allowedHeaders: ['Content-Type', 'Authorization'],
    maxAge: 86400,
  };

  return cors(options);
};
ts
// src/index.ts
import express from 'express';
import { corsMiddleware } from './middleware/cors';

const app = express();

app.use(corsMiddleware());
app.options('*', corsMiddleware()); // Preflight untuk semua routes
Tambahkan juga log validasi:

ts
// src/config/env.ts
if (!process.env.CORS_ORIGIN) {
  throw new Error('CORS_ORIGIN environment variable is required');
}
console.log('✅ CORS enabled for:', process.env.CORS_ORIGIN);
Dengan setup di atas dan CORS_ORIGIN=https://crm-n8n-dashboard.vercel.app, request dari Vercel akan SELALU diizinkan dan tidak muncul error CORS.

B. Authentication (JWT)
ts
// JWT middleware untuk semua endpoints
// Spesifikasi:
// - Ambil token dari header: Authorization: Bearer <token>
// - Payload minimal: { id, role, email, iat, exp }
// - Token expiry: 7 hari
// - Sediakan endpoint refresh token
// - Kalau token invalid/expired → response 401 dengan pesan jelas
C. Businesses Routes
text
GET    /api/businesses              // List semua businesses (pagination + filters)
GET    /api/businesses/:id          // Get single business
POST   /api/businesses              // Create new business
PUT    /api/businesses/:id          // Update business
DELETE /api/businesses/:id          // Delete business
POST   /api/businesses/bulk-import  // Import dari CSV/JSON (update lead_score)
GET    /api/businesses/stats        // Get dashboard stats
GET    /api/businesses/filter       // Filter by status, has_phone, lead_score, campaign_batch
Business Logic:

Auto-calculate lead_score berdasarkan: rating, user_ratings_total, has_phone, message_sent, contact_attempts

Track status: new → contacted → interested → cold → invalid_whatsapp

Cooldown: jangan kontak business yang baru contact dalam 24 jam

D. Customers Routes
text
GET    /api/customers                     // List semua customers (pagination)
GET    /api/customers/:id                 // Get single customer + chat history
POST   /api/customers                     // Create new customer
PUT    /api/customers/:id                 // Update customer (priority, status, dll)
DELETE /api/customers/:id                 // Soft delete customer
GET    /api/customers/search              // Search by phone/name
GET    /api/customers/cooldown-check      // Check cooldown status
POST   /api/customers/:id/reset-cooldown  // Admin force reset cooldown
Business Logic:

conversation_stage: greeting → needs_assessment → proposal → negotiation → closed

cooldown_until: Auto-set 24 jam setelah message sent

is_cooldown_active: current_time < cooldown_until

message_count_today: Reset setiap 00:00 UTC

conversation_quality_score: Hitung dari chat history + sentiment analysis

E. Chat Routes
text
GET    /api/chat/history/:customerId      // Get chat history (pagination)
POST   /api/chat/send                     // Send message + classify + escalate if needed
POST   /api/chat/classify                 // AI classification untuk received message
GET    /api/chat/analytics                // Chat analytics (total, escalated, resolved)
Business Logic:

Auto-classify messages: greeting, question, complaint, purchase_intent, dll

Simpan confidence score dari AI

Jika escalation keywords terdeteksi → auto buat escalation record

Log processing_time_ms untuk monitoring

F. Escalations Routes
text
GET    /api/escalations                   // List escalations (with filters)
GET    /api/escalations/:id               // Get escalation detail
POST   /api/escalations                   // Create escalation
PUT    /api/escalations/:id               // Update escalation (status, assigned_to)
DELETE /api/escalations/:id               // Close escalation
GET    /api/escalations/priority/:level   // Filter by priority level
GET    /api/escalations/stats             // Escalation dashboard stats
Business Logic:

Priority levels: low, normal, high, critical

Status flow: open → in_progress → resolved → closed

Hitung response_time_minutes = resolved_at - created_at

Auto-assign berdasarkan workload distribution

G. Knowledge Base Routes
text
GET    /api/knowledge                     // List semua knowledge (pagination)
GET    /api/knowledge/:id                 // Get single knowledge
POST   /api/knowledge                     // Create knowledge entry
PUT    /api/knowledge/:id                 // Update knowledge
DELETE /api/knowledge/:id                 // Delete (soft delete)
POST   /api/knowledge/search              // Match knowledge by user message
GET    /api/knowledge/categories          // List categories + usage stats
Business Logic:

Gunakan function DB match_knowledge() untuk keyword search

Return top 3 matches berdasarkan priority

Update usage_count & last_used setiap kali match

Support category hierarchy

H. WhatsApp Routes
text
POST   /api/whatsapp/send                 // Send message to customer
POST   /api/whatsapp/webhook              // Receive message webhook (dari n8n)
GET    /api/whatsapp/status/:messageId    // Check message delivery status
POST   /api/whatsapp/broadcast            // Send bulk message ke businesses
Business Logic:

Integrasi langsung dengan WHATSAPP_API_URL pakai WHATSAPP_API_KEY

Retry mechanism (exponential backoff) kalau send gagal

Rate limiting: max 100 messages/minute per account

Simpan message_id untuk tracking delivery

Webhook handler untuk incoming messages → update chat_history & customers

I. Analytics Routes
text
GET    /api/analytics/dashboard           // Main dashboard stats
GET    /api/analytics/customers           // Customer engagement stats (view)
GET    /api/analytics/campaigns           // Campaign performance (materialized view)
GET    /api/analytics/export              // Export data ke CSV/JSON
POST   /api/analytics/refresh-cache       // Manual refresh materialized views
Business Logic:

Query dari materialized views untuk performance

Cache results dengan Redis (TTL 5 menit)

Auto-refresh views setiap 1 jam

Support date range filtering

3. Error Handling & Validation
ts
// Global error handler middleware
// Requirement:
// - Input validation pakai Zod atau Joi di layer controller/service
// - Custom error responses dengan HTTP status yang tepat
//   - 400: validation errors
//   - 401: auth errors
//   - 403: forbidden
//   - 404: not found
//   - 409: conflict (duplicate, dsb)
//   - 500: server errors
// - Logging semua errors ke console/file (minimal path + message)
4. Database Connection
ts
// Prisma configuration requirements:
// - Connection pooling (max 20 connections)
// - Auto-retry pada connection timeout
// - Query logging ON di development, OFF atau minimal di production
// - Migration support untuk schema changes (prisma migrate)
FRONTEND REQUIREMENTS
1. Project Structure
text
frontend/
├── src/
│   ├── components/
│   │   ├── Dashboard/
│   │   │   ├── Dashboard.tsx        // Main dashboard + stats cards
│   │   │   ├── StatCard.tsx
│   │   │   └── Charts.tsx           // Campaign performance, customer engagement
│   │   ├── Businesses/
│   │   │   ├── BusinessList.tsx     // Table + pagination + filters
│   │   │   ├── BusinessForm.tsx     // Create/edit form
│   │   │   ├── BulkImport.tsx       // CSV import
│   │   │   └── LeadScoring.tsx      // Visualisasi lead_score
│   │   ├── Customers/
│   │   │   ├── CustomerList.tsx     // Table + filters
│   │   │   ├── CustomerDetail.tsx   // Detail + chat history
│   │   │   ├── CustomerForm.tsx     // Create/edit
│   │   │   └── CooldownStatus.tsx   // Cooldown indicator
│   │   ├── Chat/
│   │   │   ├── ChatWindow.tsx       // Message display + input
│   │   │   ├── MessageList.tsx      // Message thread
│   │   │   ├── ClassificationBadge.tsx   // Show AI classification
│   │   │   └── EscalationAlert.tsx       // Auto escalation notification
│   │   ├── Escalations/
│   │   │   ├── EscalationList.tsx   // Table + priority filter
│   │   │   ├── EscalationDetail.tsx// Detail + assignment
│   │   │   └── PriorityIndicator.tsx// Visual priority
│   │   ├── Knowledge/
│   │   │   ├── KnowledgeBase.tsx    // List + search
│   │   │   ├── KnowledgeForm.tsx    // Create/edit
│   │   │   └── UsageStats.tsx       // Track knowledge usage
│   │   ├── Analytics/
│   │   │   ├── EngagementStats.tsx  // Customer engagement view
│   │   │   ├── CampaignMetrics.tsx  // Campaign performance
│   │   │   └── ExportData.tsx       // CSV export
│   │   ├── Common/
│   │   │   ├── Navbar.tsx
│   │   │   ├── Sidebar.tsx
│   │   │   ├── Button.tsx
│   │   │   ├── Modal.tsx
│   │   │   ├── Loading.tsx
│   │   │   └── ErrorBoundary.tsx
│   ├── hooks/
│   │   ├── useApi.ts           // Custom hook untuk API calls
│   │   ├── useAuth.ts          // Authentication management
│   │   ├── usePagination.ts    // Pagination logic
│   │   └── useFilters.ts       // Filter state management
│   ├── services/
│   │   ├── api.ts              // Axios instance + base URL
│   │   ├── businessService.ts  // API calls untuk businesses
│   │   ├── customerService.ts  // API calls untuk customers
│   │   ├── chatService.ts      // API calls untuk chat
│   │   ├── escalationService.ts// API calls untuk escalations
│   │   ├── knowledgeService.ts // API calls untuk knowledge
│   │   ├── analyticsService.ts // API calls untuk analytics
│   │   └── whatsappService.ts  // API calls untuk WhatsApp
│   ├── store/
│   │   ├── authStore.ts        // Zustand/Redux untuk auth state
│   │   ├── businessStore.ts
│   │   ├── customerStore.ts
│   │   ├── chatStore.ts
│   │   └── notificationStore.ts
│   ├── types/
│   │   ├── index.ts            // TypeScript interfaces
│   │   ├── api.ts              // API response types
│   │   └── models.ts           // Data models
│   ├── pages/
│   │   ├── Home.tsx
│   │   ├── Businesses.tsx
│   │   ├── Customers.tsx
│   │   ├── Chat.tsx
│   │   ├── Escalations.tsx
│   │   ├── Knowledge.tsx
│   │   ├── Analytics.tsx
│   │   └── Settings.tsx
│   ├── styles/
│   │   ├── globals.css         // TailwindCSS imports
│   │   ├── components.css
│   │   └── animations.css
│   ├── App.tsx                 // Main router
│   ├── main.tsx                // Entry point
│   └── index.css
├── .env
├── vite.config.ts
├── tailwind.config.js
└── package.json
2. Core Features Implementation
A. Dashboard Page
ts
// Requirements:
// - 6 stat cards: Total Businesses, Active Customers, Unresolved Escalations,
//   Messages Sent Today, Avg Conversation Quality, Campaign Performance
// - Real-time stats refresh setiap 10 detik
// - 2 charts: Campaign performance (bar), Customer engagement trend (line)
// - Quick actions: New Business, New Customer, Send Message
// - Cooldown status indicator untuk businesses yang bisa dihubungi hari ini
B. Businesses Management
ts
// Table columns: place_id, name, phone, address, rating, lead_score,
// status, contact_attempts, last_contacted, campaign_batch
// Filters: status (new/contacted/interested/cold/invalid), has_phone,
//          lead_score range, campaign_batch
// Pagination: 25 rows/page
// Actions: View detail, Edit, Send WhatsApp, Delete, Bulk import
// Lead scoring visualization: red < 30, yellow 30-70, green > 70
// Bulk import: upload CSV, auto-map columns, validate phone numbers
C. Customers Management
ts
// Table: phone, name, location, material, product_type, status,
//        customer_priority, conversation_stage, last_interaction
// Filters: status, priority, conversation_stage, message_count_today
// Cooldown badge: merah jika active, hijau jika bisa contact
// Actions: View detail, Edit, Send message, Send WhatsApp,
//          View chat history, Create escalation
// Customer detail modal: full profile + chat history + escalations
D. Chat Window
ts
// Message thread layout: right = sent, left = received
// Tampilkan timestamp + AI classification badge
// Input field + character counter
// Send button disabled kalau cooldown active
// Auto-classify incoming messages + tampilkan confidence score
// Escalation trigger: auto-create escalation jika keyword detected
//                       + tampilkan toast notification
// Search messages: filter by classification + date range
E. Escalations Management
ts
// Table: escalation_type, priority_level, status, assigned_to,
//        customer_name, created_at, response_time_minutes
// Filters: priority (low/normal/high/critical), status (open/in_progress/resolved)
// Color-coded priority: low (blue), normal (green), high (orange), critical (red)
// Actions: View detail, Assign, Update status, Add note, Close
// Detail modal: customer info + chat context + escalation history
F. Knowledge Base Management
ts
// Table: category, keywords, question_pattern, answer_template,
//        priority, usage_count, last_used
// Filters: category, is_active, priority range
// Pagination: 20 rows/page
// Actions: View, Edit, Delete, Test match
// Test match form: input customer message → tampilkan matching knowledge
//        entries + confidence
// Usage stats: chart (last 7 days) untuk most used knowledge entries
G. Analytics & Reporting
ts
// 2 tabs: Customer Engagement, Campaign Performance
// Tab 1 (customer_engagement_stats view):
//   - Table: customer phone, name, total_chats, last_chat_at,
//            escalation_count, avg_quality_score
//   - Filter by date range, priority
// Tab 2 (campaign_performance view):
//   - Table: campaign_batch, total_leads, contacted, invalid,
//            avg_lead_score, batch_date
//   - Chart: campaign conversion rate + lead quality over time
// Export button: download CSV dengan selected data
3. UI/UX Requirements
ts
// Design: modern, clean, professional (boleh gunakan ShadCN UI / MUI)
// Color scheme: primary (teal/blue), secondary (gray), status (green/red/yellow)
// Responsive: mobile-first, support tablet + desktop
// Loading states: skeleton screens untuk tables, spinners untuk buttons
// Error handling: toast notifications untuk errors & success
// Accessibility: WCAG 2.1 AA (keyboard navigation, screen reader)
// Animation: smooth transitions, tidak mengganggu
4. API Integration
ts
// useApi hook requirements:
// - Manage loading, error, data states
// - Auto-retry pada network failure (3x, exponential backoff)
// - Cache responses (TTL 5 menit)
// - Tambah Authorization header secara otomatis
// - Tangani CORS errors dengan message yang jelas ke user
// Axios instance (api.ts) harus pakai baseURL dari REACT_APP_API_BASE_URL
5. State Management
ts
// Gunakan Zustand untuk global state (lebih ringan dari Redux)
// Stores: auth, businesses, customers, chat, notifications
// Persist auth token ke localStorage
// Sync filter & pagination state ke URL params (supaya bisa di-bookmark)
DEPLOYMENT CHECKLIST
Backend (Easypanel VPS)
Setup Node.js + npm di VPS

Clone backend repo

Install dependencies: npm install

Buat file .env dengan credentials di atas

Setup database:

npx prisma migrate dev (atau manual SQL import jika schema sudah ada)

npx prisma db seed (optional – seed knowledge base + sample data)

Compile TypeScript: npm run build

Setup PM2 untuk auto-restart:
pm2 start dist/index.js --name crm-backend

Setup nginx reverse proxy (port 4444 → public domain)

Setup SSL certificate (Let's Encrypt via Certbot)

Test CORS:

bash
curl -H "Origin: https://crm-n8n-dashboard.vercel.app" \
     -H "Access-Control-Request-Method: GET" \
     -X OPTIONS https://filter-bot-crmcutting.qk6yxt.easypanel.host/api/businesses
Pastikan response mengandung header:
Access-Control-Allow-Origin: https://crm-n8n-dashboard.vercel.app

Setup monitoring + logging (PM2 logs, nginx logs)

Frontend (Vercel)
Push code ke GitHub repo

Connect repo ke Vercel project

Set environment variables di Vercel: REACT_APP_API_BASE_URL

Deploy branch main (auto-deploy on push)

Setup custom domain + SSL

Test CORS dari browser (fetch ke /api/businesses dan pastikan tidak ada error)

Monitor performance via Vercel Analytics

TESTING CHECKLIST
Backend
Unit tests: service layer (lead scoring, AI classification, cooldown)

Integration tests: semua API endpoints (CRUD operations)

Error scenarios: invalid input, auth failures, database errors

Load testing: 1000 concurrent requests ke /api/dashboard

WhatsApp integration: test send message success + failure

CORS tests:

Request dari origin yang diizinkan → sukses

Request dari origin yang tidak diizinkan → diblock (tanpa crash server)

Frontend
Component tests: rendering & user interactions

E2E tests: flow utama (login → view dashboard → send message → escalate)

Performance: Lighthouse score > 90, bundle size < 300KB

Accessibility: cek dengan axe DevTools

JANGAN LUPA
✅ CORS configuration sudah include CORS_ORIGIN dan validasi saat startup

✅ JWT authentication untuk semua protected routes

✅ Input validation (backend & frontend)

✅ Error handling dengan pesan yang jelas

✅ Pagination untuk large datasets

✅ Database indexes untuk performance

✅ Prisma migrations untuk schema management

✅ Environment variable validation di startup

✅ Rate limiting untuk WhatsApp API calls

✅ Soft delete pattern untuk data retention

✅ Timestamp tracking (created_at, updated_at, last_contacted)

✅ Cooldown system dengan database-level checks

✅ Materialized views untuk dashboard stats

✅ File upload handling untuk bulk import (CSV)

✅ WebSocket support optional untuk real-time notifications

ANTISIPASI ERROR & KONFIRMASI INTEGRASI (SUDAH TERSAMBUNG & BEBAS ERROR)
Tambahkan dan WAJIB IKUTI langkah-langkah verifikasi berikut agar sistem dipastikan tersambung dengan benar TANPA error CORS, TANPA error koneksi DB, dan TANPA error API:

1. Checklist Antisipasi CORS
Pastikan CORS_ORIGIN di environment VPS di-set ke:

text
CORS_ORIGIN=https://crm-n8n-dashboard.vercel.app
Jangan lupa restart backend setelah mengubah env atau kode CORS.

Jalankan test manual dari lokal/browser console:

js
fetch('https://filter-bot-crmcutting.qk6yxt.easypanel.host/api/businesses', {
  method: 'GET',
  headers: { 'Content-Type': 'application/json' },
})
.then(r => r.json())
.then(d => console.log('✅ CORS OK:', d))
.catch(e => console.error('❌ CORS FAILED:', e));
Jika masih ada error CORS, log yang diharapkan di backend:

Tampilkan origin yang diterima

Tampilkan daftar origins yang diizinkan

Goal: Setelah step ini, tidak boleh ada lagi error:
No 'Access-Control-Allow-Origin' header is present on the requested resource.

2. Checklist Antisipasi Koneksi Database
Jalankan script health check di backend endpoint:

text
GET /api/health
Response yang diharapkan:

json
{
  "status": "ok",
  "db": "connected",
  "uptime": <number>,
  "version": "1.0.0"
}
Jika koneksi DB gagal:

Log error message lengkap (hostname, port, dbname, tapi tanpa password).

Return HTTP 500 dengan message generic.

3. Checklist Antisipasi WhatsApp API
Tambahkan endpoint test:

text
POST /api/whatsapp/test
Yang mengirim message dummy ke nomor test dan mengembalikan status dari WHATSAPP_API_URL.

Log success & failure (status code + response body) untuk debugging.

4. Checklist Integrasi Frontend–Backend
Semua service di frontend/src/services/*.ts harus menggunakan REACT_APP_API_BASE_URL sebagai base URL.

Uji minimal 1 request dari setiap resource:

/api/businesses

/api/customers

/api/chat/history/:id

/api/escalations

/api/knowledge

/api/analytics/dashboard

Pastikan tidak ada error Network ataupun CORS di browser DevTools.

5. Checklist Error Handling Teruji
Test kasus invalid input (misal kirim body kosong ke endpoint POST /api/businesses).

Harus return 400 Bad Request dengan detail error.

Test akses tanpa JWT ke endpoint protected (misal GET /api/customers).

Harus return 401 Unauthorized.

Test akses resource yang tidak ada (misal GET /api/customers/999999).

Harus return 404 Not Found.

6. Checklist Final "Semua Tersambung"
Sebelum dianggap selesai dan stabil, jalankan flow ini end-to-end:

Buka frontend (Vercel) → login (kalau ada auth).

Buka Dashboard → semua stat cards ter-load tanpa error.

Buka Businesses → data muncul, filter jalan, tidak ada error.

Buka Customers → bisa view detail + chat history.

Kirim 1 pesan via Chat Window →

Terekam di chat_history

Kalau mengandung keyword tertentu → escalation tercipta

Kirim 1 pesan via WhatsApp endpoint → cek bahwa request ke WHATSAPP_API_URL sukses.

Buka Analytics → charts tampil, data sesuai dari views.

Jika semua langkah di atas berhasil tanpa error di console browser, tanpa error di log backend, dan tanpa error di DB, anggap sistem SUDAH TERUJI & TERSAMBUNG SEPENUHNYA.

Instruksi ke AI (Gemini 3 Pro):

Gunakan semua spesifikasi di dokumen ini sebagai single source of truth.

Generate struktur project, file, dan implementasi code lengkap (backend + frontend) sesuai detail di atas.

Pastikan konfigurasi CORS mengikuti contoh kode cors.ts dan index.ts sehingga tidak ada lagi error CORS antara Vercel frontend dan Easypanel backend.

Setelah generate, sertakan juga README singkat berisi langkah-langkah run local & deploy.