<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Dashboard - Tepat Laser</title>
    <meta name="description" content="CRM Dashboard Tepat Laser dengan integrasi n8n untuk customer service, marketing, dan analitik.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./styles/tailwind.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.469.0/lucide.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/locale/id.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --bg-gradient-start: #0f172a;
            --bg-gradient-end: #1e293b;
            --glass-surface: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.18);
            --glass-shadow: 0 24px 45px -30px rgba(15, 23, 42, 0.55);
            --primary: #38bdf8;
            --primary-soft: rgba(56, 189, 248, 0.15);
            --accent: #22d3ee;
            --success: #34d399;
            --warning: #fbbf24;
            --danger: #f87171;
            --info: #60a5fa;
        }

        :root[data-theme="light"] {
            --page-bg: linear-gradient(180deg, #f8fbff 0%, #ecfdf5 100%);
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --surface: rgba(255, 255, 255, 0.92);
            --surface-muted: rgba(255, 255, 255, 0.7);
            --border-subtle: rgba(15, 23, 42, 0.06);
        }

        :root[data-theme="dark"] {
            --page-bg: radial-gradient(circle at 20% 20%, rgba(37, 99, 235, 0.18), transparent 50%),
                radial-gradient(circle at 80% 10%, rgba(6, 182, 212, 0.15), transparent 45%),
                radial-gradient(circle at 50% 70%, rgba(14, 165, 233, 0.12), transparent 55%),
                #020617;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --surface: rgba(15, 23, 42, 0.6);
            --surface-muted: rgba(15, 23, 42, 0.4);
            --border-subtle: rgba(148, 163, 184, 0.12);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--page-bg);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
        }

        .glass-card {
            background: var(--surface);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(18px);
            box-shadow: var(--glass-shadow);
        }

        .glass-muted {
            background: var(--surface-muted);
            border: 1px solid var(--border-subtle);
            backdrop-filter: blur(10px);
        }

        .tab-button {
            transition: all 0.3s ease;
        }

        .tab-button.active {
            color: var(--primary);
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .stat-card {
            position: relative;
            overflow: hidden;
            transition: transform 0.35s ease, box-shadow 0.35s ease;
        }

        .stat-card::after {
            content: "";
            position: absolute;
            inset: 0;
            opacity: 0;
            background: linear-gradient(140deg, rgba(56, 189, 248, 0.22), rgba(34, 211, 238, 0.12));
            transition: opacity 0.35s ease;
        }

        .stat-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 30px 60px -40px rgba(14, 165, 233, 0.55);
        }

        .stat-card:hover::after {
            opacity: 1;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            border-radius: 9999px;
            font-weight: 500;
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            letter-spacing: 0.02em;
        }

        .badge-success { background: rgba(52, 211, 153, 0.15); color: #10b981; }
        .badge-warning { background: rgba(251, 191, 36, 0.15); color: #d97706; }
        .badge-danger { background: rgba(248, 113, 113, 0.18); color: #dc2626; }
        .badge-info { background: rgba(96, 165, 250, 0.18); color: #2563eb; }
        .badge-neutral { background: rgba(148, 163, 184, 0.16); color: #475569; }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 9999px;
            display: inline-block;
        }

        .table-wrap {
            overflow: hidden;
            border-radius: 1.25rem;
        }

        table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
        }

        thead th {
            position: sticky;
            top: 0;
            z-index: 5;
            background: rgba(15, 23, 42, 0.05);
            backdrop-filter: blur(12px);
            text-transform: uppercase;
            font-size: 0.7rem;
            letter-spacing: 0.12em;
            font-weight: 600;
            color: var(--text-secondary);
        }

        tbody tr {
            transition: background 0.25s ease, transform 0.25s ease;
        }

        tbody tr:hover {
            background: rgba(56, 189, 248, 0.08);
            transform: translateY(-2px);
        }

        tbody td, thead th {
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--border-subtle);
        }

        .actions button {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .actions button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 20px -12px rgba(14, 165, 233, 0.45);
        }

        .skeleton {
            background: linear-gradient(90deg, rgba(148, 163, 184, 0.2), rgba(148, 163, 184, 0.35), rgba(148, 163, 184, 0.2));
            background-size: 200% 100%;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        @media (max-width: 1024px) {
            .stat-grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        @media (max-width: 768px) {
            thead { display: none; }
            tbody tr {
                display: grid;
                grid-template-columns: repeat(2, minmax(0, 1fr));
                gap: 0.5rem;
                padding: 0.75rem 0.5rem;
            }

            tbody td {
                padding: 0.5rem;
                border: none;
                font-size: 0.875rem;
            }

            tbody td::before {
                content: attr(data-label);
                font-weight: 600;
                display: block;
                color: var(--text-secondary);
                margin-bottom: 0.25rem;
            }
        }
    </style>
</head>
<body class="antialiased" data-theme="light">
    <div class="pointer-events-none fixed inset-x-0 top-0 z-0 h-[540px] bg-gradient-to-br from-sky-300/20 via-cyan-200/25 to-emerald-200/20 blur-3xl"></div>
    <div class="relative z-10 flex min-h-screen flex-col">
        <header class="max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 pt-10">
            <div class="glass-card rounded-3xl px-6 py-6 md:px-10 md:py-8">
                <div class="flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between">
                    <div class="flex flex-col gap-4 sm:flex-row sm:items-center">
                        <div class="flex h-14 w-14 items-center justify-center rounded-2xl bg-gradient-to-br from-sky-500 via-cyan-400 to-emerald-400 text-white shadow-xl shadow-sky-500/30">
                            <span class="text-xl font-semibold">TL</span>
                        </div>
                        <div>
                            <p class="text-xs font-medium uppercase tracking-[0.35em] text-slate-400">CRM Dashboard</p>
                            <h1 class="text-3xl font-semibold">Tepat Laser Command Center</h1>
                            <p class="mt-1 text-sm text-slate-500">Integrasi real-time dengan workflow n8n &amp; PostgreSQL</p>
                        </div>
                    </div>
                    <div class="flex flex-col-reverse gap-4 sm:flex-row sm:items-center">
                        <div class="flex items-center gap-4 rounded-full bg-white/60 px-4 py-2 text-sm text-slate-600 shadow-sm shadow-sky-200/40">
                            <div class="flex items-center gap-2">
                                <span class="status-indicator bg-emerald-400" id="connection-indicator"></span>
                                <span id="connection-status">Mengecek koneksi...</span>
                            </div>
                            <span class="hidden sm:block text-slate-400">•</span>
                            <div class="flex items-center gap-2 text-slate-500">
                                <i data-lucide="clock"></i>
                                <span>Update terakhir: <span id="last-updated">-</span></span>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <label class="flex items-center gap-2 rounded-full bg-white/60 px-3 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500 shadow-sm shadow-sky-200/40">
                                Auto refresh
                                <select id="refresh-interval" class="rounded-full border-none bg-transparent text-slate-700 focus:ring-0">
                                    <option value="0">Off</option>
                                    <option value="30000">30s</option>
                                    <option value="60000">1m</option>
                                    <option value="300000">5m</option>
                                </select>
                            </label>
                            <button id="refresh-data" class="inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-sky-500 to-cyan-400 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/40 transition">
                                <i data-lucide="refresh-ccw" class="h-4 w-4"></i>
                                Refresh data
                                <span id="refresh-countdown" class="ml-2 text-xs font-medium text-white/70"></span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="mt-6 grid gap-4 rounded-2xl bg-slate-900/5 p-4 text-xs text-slate-500 sm:grid-cols-3">
                    <div class="flex items-center gap-2">
                        <i data-lucide="bell-ring" class="h-4 w-4 text-amber-400"></i>
                        <span>Ada <strong id="new-items-count">0</strong> update baru sejak refresh terakhir</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <i data-lucide="activity" class="h-4 w-4 text-sky-400"></i>
                        <span>Status real-time: <strong id="realtime-status" class="text-emerald-500">Standby</strong></span>
                    </div>
                    <div class="flex items-center gap-2">
                        <i data-lucide="calendar-range" class="h-4 w-4 text-cyan-400"></i>
                        <span>Periode: <span id="active-date-range">Semua waktu</span></span>
                    </div>
                </div>
            </div>
        </header>

        <main class="relative mx-auto w-full max-w-7xl flex-1 px-4 pb-16 sm:px-6 lg:px-8">
            <div class="mt-10">
                <div class="glass-card rounded-3xl p-4 sm:p-6 lg:p-8">
                    <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                        <div>
                            <h2 class="text-2xl font-semibold">Ringkasan Operasional</h2>
                            <p class="text-sm text-slate-500">Monitor performa harian, analitik marketing, dan kesehatan tim layanan pelanggan.</p>
                        </div>
                        <div class="flex flex-wrap items-center gap-3 text-xs text-slate-500">
                            <div class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                <span class="h-2 w-2 rounded-full bg-sky-400"></span>
                                Trend harian
                            </div>
                            <div class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                <span class="h-2 w-2 rounded-full bg-emerald-400"></span>
                                Mingguan
                            </div>
                            <div class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                <span class="h-2 w-2 rounded-full bg-violet-400"></span>
                                Bulanan
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 grid gap-4 md:grid-cols-2 lg:grid-cols-4 stat-grid" id="stat-cards">
                        <article class="stat-card glass-muted rounded-3xl p-6 shadow-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Total Pelanggan</p>
                                    <h3 class="mt-2 text-3xl font-semibold" id="total-customers">-</h3>
                                    <p class="mt-2 flex items-center gap-2 text-sm text-slate-500">
                                        <span id="customers-delta" class="badge badge-success">0%</span>
                                        <span id="customers-period">vs minggu lalu</span>
                                    </p>
                                </div>
                                <div class="rounded-2xl bg-sky-500/10 p-3 text-sky-500">
                                    <i data-lucide="users" class="h-6 w-6"></i>
                                </div>
                            </div>
                            <canvas id="sparkline-customers" class="mt-4 h-16"></canvas>
                        </article>
                        <article class="stat-card glass-muted rounded-3xl p-6 shadow-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Leads Marketing</p>
                                    <h3 class="mt-2 text-3xl font-semibold" id="total-leads">-</h3>
                                    <p class="mt-2 flex items-center gap-2 text-sm text-slate-500">
                                        <span id="leads-delta" class="badge badge-info">0%</span>
                                        <span id="leads-period">vs minggu lalu</span>
                                    </p>
                                </div>
                                <div class="rounded-2xl bg-cyan-500/10 p-3 text-cyan-500">
                                    <i data-lucide="radar" class="h-6 w-6"></i>
                                </div>
                            </div>
                            <canvas id="sparkline-leads" class="mt-4 h-16"></canvas>
                        </article>
                        <article class="stat-card glass-muted rounded-3xl p-6 shadow-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Escalations</p>
                                    <h3 class="mt-2 text-3xl font-semibold" id="total-escalations">-</h3>
                                    <p class="mt-2 flex items-center gap-2 text-sm text-slate-500">
                                        <span id="escalations-delta" class="badge badge-warning">0%</span>
                                        <span id="escalations-period">vs minggu lalu</span>
                                    </p>
                                </div>
                                <div class="rounded-2xl bg-amber-500/10 p-3 text-amber-500">
                                    <i data-lucide="alert-triangle" class="h-6 w-6"></i>
                                </div>
                            </div>
                            <canvas id="sparkline-escalations" class="mt-4 h-16"></canvas>
                        </article>
                        <article class="stat-card glass-muted rounded-3xl p-6 shadow-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Response Rate</p>
                                    <h3 class="mt-2 text-3xl font-semibold" id="response-rate">-</h3>
                                    <p class="mt-2 flex items-center gap-2 text-sm text-slate-500">
                                        <span id="response-rate-delta" class="badge badge-success">0%</span>
                                        <span id="response-period">SLA realtime</span>
                                    </p>
                                </div>
                                <div class="rounded-2xl bg-emerald-500/10 p-3 text-emerald-500">
                                    <i data-lucide="message-circle" class="h-6 w-6"></i>
                                </div>
                            </div>
                            <canvas id="sparkline-response" class="mt-4 h-16"></canvas>
                        </article>
                    </div>

                    <div class="mt-10 grid gap-6 lg:grid-cols-3">
                        <section class="glass-muted rounded-3xl p-6 shadow-lg lg:col-span-2">
                            <header class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Response Time Trend</h3>
                                    <p class="text-sm text-slate-500">Rata-rata waktu respon harian dan performa SLA.</p>
                                </div>
                                <div class="flex items-center gap-3 text-xs text-slate-500">
                                    <span class="inline-flex items-center gap-1 rounded-full bg-emerald-500/10 px-2 py-1 text-emerald-600">
                                        <i data-lucide="trending-up" class="h-4 w-4"></i>
                                        7 hari terakhir
                                    </span>
                                </div>
                            </header>
                            <canvas id="chart-response-time" class="mt-6 h-72"></canvas>
                        </section>
                        <section class="glass-muted rounded-3xl p-6 shadow-lg">
                            <header class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Distribusi Escalation</h3>
                                    <p class="text-sm text-slate-500">Status real-time tiket aktif vs terselesaikan.</p>
                                </div>
                                <button id="export-escalations" class="text-xs font-semibold uppercase tracking-wide text-sky-500">Export CSV</button>
                            </header>
                            <canvas id="chart-escalations" class="mt-6 h-64"></canvas>
                        </section>
                    </div>

                    <div class="mt-6 grid gap-6 lg:grid-cols-3">
                        <section class="glass-muted rounded-3xl p-6 shadow-lg">
                            <header class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Funnel Konversi</h3>
                                    <p class="text-sm text-slate-500">Perjalanan lead menjadi pelanggan.</p>
                                </div>
                            </header>
                            <canvas id="chart-funnel" class="mt-6 h-72"></canvas>
                        </section>
                        <section class="glass-muted rounded-3xl p-6 shadow-lg">
                            <header class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Leaderboard Tim</h3>
                                    <p class="text-sm text-slate-500">Top performers berdasarkan SLA &amp; CSAT.</p>
                                </div>
                            </header>
                            <ul class="mt-6 space-y-4" id="team-leaderboard"></ul>
                        </section>
                        <section class="glass-muted rounded-3xl p-6 shadow-lg">
                            <header class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Kepuasan Pelanggan</h3>
                                    <p class="text-sm text-slate-500">Skor CSAT dan feedback terbaru.</p>
                                </div>
                            </header>
                            <div class="mt-6 flex flex-col gap-6">
                                <div>
                                    <div class="flex items-center gap-2 text-3xl font-semibold">
                                        <span id="csat-score">4.7</span>
                                        <div class="flex items-center gap-1 text-amber-400" id="csat-stars"></div>
                                    </div>
                                    <p class="mt-2 text-sm text-slate-500" id="csat-summary">Mayoritas pelanggan memberikan rating sangat baik.</p>
                                </div>
                                <div class="flex items-center gap-3 text-xs text-slate-500">
                                    <span class="badge badge-success">+5% MoM</span>
                                    <span class="inline-flex items-center gap-1 text-emerald-500">
                                        <i data-lucide="smile"></i>
                                        87% sentiment positif
                                    </span>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>

                <div class="mt-8">
                    <nav class="glass-card flex flex-wrap items-center justify-between gap-4 rounded-3xl px-4 py-3 sm:px-6">
                        <div class="flex flex-wrap items-center gap-2 sm:gap-4">
                            <button class="tab-button rounded-full px-4 py-2 text-sm font-semibold text-slate-500 hover:text-sky-500" data-tab="overview">Overview</button>
                            <button class="tab-button rounded-full px-4 py-2 text-sm font-semibold text-slate-500 hover:text-sky-500" data-tab="customer-service">Customer Service</button>
                            <button class="tab-button rounded-full px-4 py-2 text-sm font-semibold text-slate-500 hover:text-sky-500" data-tab="marketing">Marketing</button>
                            <button class="tab-button rounded-full px-4 py-2 text-sm font-semibold text-slate-500 hover:text-sky-500" data-tab="analytics">Analitik</button>
                        </div>
                        <div class="flex items-center gap-2 text-xs text-slate-500">
                            <span id="active-tab-description">Insight global dan KPI utama.</span>
                        </div>
                    </nav>

                    <section id="tab-overview" class="tab-panel mt-6 active space-y-6">
                        <div class="grid gap-6 lg:grid-cols-[2fr_1fr]">
                            <div class="glass-card rounded-3xl p-6">
                                <header class="flex items-center justify-between">
                                    <div>
                                        <h3 class="text-lg font-semibold">Aktivitas Terbaru</h3>
                                        <p class="text-sm text-slate-500">Chat, tugas, dan status terbaru dari tim.</p>
                                    </div>
                                    <button class="text-xs font-semibold uppercase tracking-wide text-sky-500">Lihat semua</button>
                                </header>
                                <ul id="recent-activities" class="mt-6 space-y-4"></ul>
                            </div>
                            <div class="glass-card rounded-3xl p-6">
                                <header class="flex items-center justify-between">
                                    <div>
                                        <h3 class="text-lg font-semibold">Notifikasi</h3>
                                        <p class="text-sm text-slate-500">Escalation dan SLA yang membutuhkan perhatian.</p>
                                    </div>
                                    <span class="badge badge-danger" id="notification-badge">0 Urgent</span>
                                </header>
                                <ul id="notification-list" class="mt-6 space-y-4"></ul>
                            </div>
                        </div>
                        <div class="glass-card rounded-3xl p-6">
                            <header class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Quick Actions</h3>
                                    <p class="text-sm text-slate-500">Tindakan cepat untuk menjaga momentum tim.</p>
                                </div>
                                <div class="flex items-center gap-2 text-xs text-slate-500">
                                    <i data-lucide="zap" class="h-4 w-4"></i>
                                    <span>Semua aksi tercatat dalam log aktivitas</span>
                                </div>
                            </header>
                            <div class="mt-6 grid gap-4 md:grid-cols-3">
                                <button class="quick-action glass-muted flex items-center justify-between rounded-2xl px-5 py-4 text-left transition" data-action="assign-lead">
                                    <div>
                                        <h4 class="text-base font-semibold">Assign Lead</h4>
                                        <p class="mt-1 text-sm text-slate-500">Distribusi lead baru ke tim marketing.</p>
                                    </div>
                                    <i data-lucide="user-plus" class="h-6 w-6 text-sky-500"></i>
                                </button>
                                <button class="quick-action glass-muted flex items-center justify-between rounded-2xl px-5 py-4 text-left transition" data-action="resolve-escalation">
                                    <div>
                                        <h4 class="text-base font-semibold">Resolve Escalation</h4>
                                        <p class="mt-1 text-sm text-slate-500">Tandai tiket urgent sebagai selesai.</p>
                                    </div>
                                    <i data-lucide="shield-check" class="h-6 w-6 text-emerald-500"></i>
                                </button>
                                <button class="quick-action glass-muted flex items-center justify-between rounded-2xl px-5 py-4 text-left transition" data-action="send-message">
                                    <div>
                                        <h4 class="text-base font-semibold">Send Message</h4>
                                        <p class="mt-1 text-sm text-slate-500">Follow-up pelanggan prioritas tinggi.</p>
                                    </div>
                                    <i data-lucide="send" class="h-6 w-6 text-violet-500"></i>
                                </button>
                            </div>
                        </div>
                    </section>

                    <section id="tab-customer-service" class="tab-panel mt-6 space-y-6">
                        <div class="glass-card rounded-3xl p-6">
                            <header class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Customer Service Pipeline</h3>
                                    <p class="text-sm text-slate-500">Monitor status interaksi pelanggan, SLA, dan prioritas.</p>
                                </div>
                                <div class="flex flex-wrap items-center gap-3 text-sm text-slate-500">
                                    <label class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                        Cari
                                        <input id="customer-search" type="search" placeholder="Nama / Telepon" class="rounded-full border-none bg-transparent text-sm focus:ring-0" />
                                    </label>
                                    <label class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                        Prioritas
                                        <select id="customer-priority-filter" class="rounded-full border-none bg-transparent text-sm focus:ring-0">
                                            <option value="all">Semua</option>
                                            <option value="high">High</option>
                                            <option value="medium">Medium</option>
                                            <option value="low">Low</option>
                                        </select>
                                    </label>
                                    <label class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                        Tanggal
                                        <input id="customer-date-from" type="date" class="rounded-full border-none bg-transparent text-sm focus:ring-0" />
                                        <span class="text-slate-400">→</span>
                                        <input id="customer-date-to" type="date" class="rounded-full border-none bg-transparent text-sm focus:ring-0" />
                                    </label>
                                    <button id="customer-export" class="rounded-full bg-slate-900/5 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-sky-500">Export CSV</button>
                                </div>
                            </header>
                            <div class="mt-6 table-wrap glass-muted">
                                <table id="customer-table">
                                    <thead>
                                        <tr>
                                            <th class="cursor-pointer" data-sort="name">Customer Name</th>
                                            <th class="cursor-pointer" data-sort="status">Status</th>
                                            <th class="cursor-pointer" data-sort="last_contact">Last Contact</th>
                                            <th class="cursor-pointer" data-sort="response_time">Response Time</th>
                                            <th class="cursor-pointer" data-sort="priority">Priority</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                            <div class="mt-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
                                <div id="customer-pagination" class="flex items-center gap-2 text-sm text-slate-500"></div>
                                <div class="text-sm text-slate-400" id="customer-summary"></div>
                            </div>
                        </div>

                        <div class="glass-card rounded-3xl p-6">
                            <header class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Escalation Tracker</h3>
                                    <p class="text-sm text-slate-500">Prioritaskan tiket urgent dan monitor penyelesaiannya.</p>
                                </div>
                                <div class="flex items-center gap-2 text-xs text-slate-500">
                                    <span class="badge badge-danger" id="open-escalations-count">0 Open</span>
                                    <span class="badge badge-success" id="resolved-escalations-count">0 Resolved</span>
                                </div>
                            </header>
                            <div class="mt-6 table-wrap glass-muted">
                                <table id="escalation-table">
                                    <thead>
                                        <tr>
                                            <th class="cursor-pointer" data-sort="customer_name">Customer</th>
                                            <th class="cursor-pointer" data-sort="issue">Issue</th>
                                            <th class="cursor-pointer" data-sort="priority">Priority</th>
                                            <th class="cursor-pointer" data-sort="status">Status</th>
                                            <th class="cursor-pointer" data-sort="created_at">Created At</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                            <div class="mt-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
                                <div id="escalation-pagination" class="flex items-center gap-2 text-sm text-slate-500"></div>
                                <div class="text-sm text-slate-400" id="escalation-summary"></div>
                            </div>
                        </div>
                    </section>

                    <section id="tab-marketing" class="tab-panel mt-6 space-y-6">
                        <div class="glass-card rounded-3xl p-6">
                            <header class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Lead Intelligence</h3>
                                    <p class="text-sm text-slate-500">Prioritaskan follow-up berdasarkan scoring &amp; sumber lead.</p>
                                </div>
                                <div class="flex flex-wrap items-center gap-3 text-sm text-slate-500">
                                    <label class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                        Cari
                                        <input id="lead-search" type="search" placeholder="Nama / Email" class="rounded-full border-none bg-transparent text-sm focus:ring-0" />
                                    </label>
                                    <label class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                        Status
                                        <select id="lead-status-filter" class="rounded-full border-none bg-transparent text-sm focus:ring-0">
                                            <option value="all">Semua</option>
                                            <option value="new">New</option>
                                            <option value="contacted">Contacted</option>
                                            <option value="qualified">Qualified</option>
                                            <option value="won">Won</option>
                                        </select>
                                    </label>
                                    <label class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                        Assign
                                        <select id="lead-owner-filter" class="rounded-full border-none bg-transparent text-sm focus:ring-0">
                                            <option value="all">Semua</option>
                                        </select>
                                    </label>
                                    <button id="lead-export" class="rounded-full bg-slate-900/5 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-sky-500">Export CSV</button>
                                </div>
                            </header>
                            <div class="mt-6 table-wrap glass-muted">
                                <table id="leads-table">
                                    <thead>
                                        <tr>
                                            <th class="cursor-pointer" data-sort="name">Lead Name</th>
                                            <th class="cursor-pointer" data-sort="source">Source</th>
                                            <th class="cursor-pointer" data-sort="status">Status</th>
                                            <th class="cursor-pointer" data-sort="score">Score</th>
                                            <th class="cursor-pointer" data-sort="follow_up">Follow-up Date</th>
                                            <th class="cursor-pointer" data-sort="owner">Assign To</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                            <div class="mt-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
                                <div id="lead-pagination" class="flex items-center gap-2 text-sm text-slate-500"></div>
                                <div class="text-sm text-slate-400" id="lead-summary"></div>
                            </div>
                        </div>
                    </section>

                    <section id="tab-analytics" class="tab-panel mt-6 space-y-6">
                        <div class="glass-card rounded-3xl p-6">
                            <header class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold">Analitik Kinerja</h3>
                                    <p class="text-sm text-slate-500">Pantau KPI strategis, efisiensi tim, dan konversi.</p>
                                </div>
                                <div class="flex flex-wrap items-center gap-3 text-sm text-slate-500">
                                    <label class="flex items-center gap-2 rounded-full bg-slate-900/5 px-3 py-1">
                                        Periode
                                        <select id="analytics-range" class="rounded-full border-none bg-transparent text-sm focus:ring-0">
                                            <option value="7">7 Hari</option>
                                            <option value="30">30 Hari</option>
                                            <option value="90">90 Hari</option>
                                        </select>
                                    </label>
                                    <button id="analytics-export" class="rounded-full bg-slate-900/5 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-sky-500">Export CSV</button>
                                </div>
                            </header>
                            <div class="mt-6 grid gap-6 md:grid-cols-2 xl:grid-cols-3" id="analytics-widgets"></div>
                        </div>
                    </section>
                </div>
            </div>
        </main>

        <footer class="mt-auto bg-transparent pb-10">
            <div class="mx-auto max-w-7xl px-4 text-xs text-slate-500">
                <p>© <span id="current-year"></span> Tepat Laser CRM. Dibangun dengan n8n, Cloudflare Workers, dan PostgreSQL.</p>
            </div>
        </footer>
    </div>

    <div id="loading-overlay" class="fixed inset-0 z-40 hidden items-center justify-center bg-white/70 backdrop-blur-md">
        <div class="glass-card flex flex-col items-center gap-4 rounded-3xl px-10 py-8 text-center text-slate-600">
            <span class="text-sm font-semibold uppercase tracking-wide text-slate-400">Memuat data dashboard</span>
            <div class="flex gap-2">
                <span class="h-3 w-3 animate-bounce rounded-full bg-sky-400"></span>
                <span class="h-3 w-3 animate-bounce rounded-full bg-cyan-400" style="animation-delay: 0.12s"></span>
                <span class="h-3 w-3 animate-bounce rounded-full bg-emerald-400" style="animation-delay: 0.24s"></span>
            </div>
            <p class="text-xs text-slate-400">Mengambil data terbaru dari workflow n8n...</p>
        </div>
    </div>

    <template id="activity-item-template">
        <li class="rounded-2xl bg-white/60 p-4 shadow-sm shadow-sky-100/50">
            <div class="flex items-start justify-between">
                <div>
                    <p class="text-sm font-medium text-slate-700 activity-title"></p>
                    <p class="mt-1 text-xs text-slate-500 activity-detail"></p>
                </div>
                <span class="text-xs text-slate-400 activity-time"></span>
            </div>
        </li>
    </template>

    <template id="notification-item-template">
        <li class="rounded-2xl bg-white/60 p-4 shadow-sm shadow-rose-100/40">
            <div class="flex items-start justify-between">
                <div>
                    <p class="text-sm font-semibold text-rose-600 notification-title"></p>
                    <p class="mt-1 text-xs text-rose-400 notification-detail"></p>
                </div>
                <span class="badge badge-danger notification-priority"></span>
            </div>
        </li>
    </template>

    <div id="modal-overlay" class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-900/60 backdrop-blur-sm">
        <div class="modal glass-card w-full max-w-3xl rounded-3xl p-6 shadow-2xl">
            <header class="flex items-center justify-between">
                <div>
                    <h3 id="modal-title" class="text-xl font-semibold"></h3>
                    <p id="modal-subtitle" class="text-sm text-slate-500"></p>
                </div>
                <button id="modal-close" class="rounded-full bg-slate-900/5 p-2 text-slate-500 hover:text-slate-700">
                    <i data-lucide="x"></i>
                </button>
            </header>
            <div id="modal-content" class="mt-6 max-h-[65vh] overflow-y-auto pr-2"></div>
        </div>
    </div>

    <div id="toast-container" class="pointer-events-none fixed bottom-6 right-6 z-50 flex max-w-sm flex-col gap-3"></div>

    <script type="module" src="./scripts/bootstrap/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('current-year').textContent = new Date().getFullYear();
        });
    </script>
</body>
</html>
